groups:
- name: test-availability
  rules:
  # Fast burn (page): 5m window burning >14.4× the 7d budget (99.9% SLO -> 0.1% budget)
  - alert: AvailabilityBudgetBurnFast
    expr: sum(rate(http_requests_total{status=~"5.."}[5m])) / sum(rate(http_requests_total[5m])) > (0.1/100) * 14.4
    for: 2m
    labels: { severity: page }
    annotations:
      summary: "Fast error-budget burn (availability)"
      description: "5m error ratio is burning >14.4× the 7d budget."
      hint: "Check last deploy; consider rollback. Slice by path/status and check saturation."
      dashboard: "http://103.167.235.175:3000/d/test-sli"
      runbook: "https://github.com/Vitawt-The-Duke/SRE_test_task/blob/main/docs/runbooks/high-burn-rate.md"

  # Slow burn (ticket): 1h window burning >6×
  - alert: AvailabilityBudgetBurnSlow
    expr: sum(rate(http_requests_total{status=~"5.."}[1h])) / sum(rate(http_requests_total[1h])) > (0.1/100) * 6
    for: 2h
    labels: { severity: ticket }
    annotations:
      summary: "Slow error-budget burn (availability)"
      description: "1h error ratio is burning >6× the 7d budget."
      hint: "Reduce blast radius; partial rollback; investigate hottest path."
      dashboard: "http://103.167.235.175:3000/d/test-sli"
      runbook: "https://github.com/Vitawt-The-Duke/SRE_test_task/blob/main/docs/runbooks/high-burn-rate.md"
